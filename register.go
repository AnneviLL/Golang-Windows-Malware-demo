package main

import (
	"golang.org/x/sys/windows/registry"
	"log"
)

// 修改文件打开方式
func changeRegOpenT(path string,  value string) {
	k, err := registry.OpenKey(registry.CLASSES_ROOT, path, registry.ALL_ACCESS)

	if err != nil {
		log.Fatal(err)
	}
	defer k.Close()

	err = k.SetExpandStringValue("", value)
	if err != nil {
		log.Fatal(err)
	}
}

// 创建自启注册表项
func createRegAutoStart(path string,name string,value string){
	k, err := registry.OpenKey(registry.LOCAL_MACHINE, path, registry.ALL_ACCESS)
	if err != nil {
		log.Fatal(err)
	}
	defer k.Close()

	err= k.SetStringValue(name,value)
	if err!=nil {
		log.Fatal(err)
	}
}